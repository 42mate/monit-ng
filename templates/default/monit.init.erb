#!/bin/sh
#
# chkconfig: 2345 98 02
# description: monit daemon
# processname: monit
# pidfile: /var/run/monit.pid
# config: <%= @conf_file %>

. /etc/init.d/functions

CONF_FILE="<%= @conf_file %>"
PID="/var/run/monit.pid"
DAEMON="<%= @prefix %>/bin/monit"

[ -x "${DAEMON}" ] || exit 1
[ -r "${CONF_FILE}" ] || exit 1

RESULT=0

start ()
{
  echo -n "Starting $DAEMON: "
  daemon $DAEMON -c $CONF_FILE
  RESULT=$?
  [ $RESULT -eq 0 ] && touch /var/lock/monit
  return $RESULT
}

stop ()
{
  echo -n "Shutting down $DAEMON: "
  killproc -p $PID
  $RESULT=$?
  [ $RESULT -eq 0 ] && rm -f /var/lock/monit
  return $RESULT
}

reload ()
{
  echo -n "Reloading $DAEMON: "
  $prog -c $CONF_FILE reload
  $RESULT=$?
  return $RESULT
}

case "$1" in
  start)
    start
    ;;
  stop)
    stop
    ;;
  restart)
    stop
    start
    ;;
  reload)
    reload
    ;;
  status)
    status $DAEMON
    RESULT=$?
    ;;
  *)
    echo "Usage: ${0} {start|stop|restart|status}"
    ;;
esac
